<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.com.chinalife.ecdata.dao.sqlDao.trade.PropertyPremiumDao">
    <select id="getPropertyPremiumOverview" resultType="Premium">
        SELECT
            STAT_DAY statDay,KPI_VALUE_D dayAmount,KPI_VALUE_LD lastDayAmount,KPI_VALUE_M monthAmount,
            KPI_VALUE_LM lastMonthAmount,KPI_VALUE_Y yearAmount,GOAL_VALUE yearGoal
        FROM
	        DMP_APP.APP_KPI_VALUE2018_D
        WHERE
	        FIRST_LEVEL = '001' AND STAT_DAY=to_char(SYSDATE-1,'YYYYmmdd')
    </select>

    <select id="getPremiumDetailWithoutReverseAndCorrect" resultType="Order" parameterType="QueryPara">
        SELECT
        t1.JQ_POLICY_NO policyNoJQ, t1.SY_POLICY_NO policyNoSY,t1.DEPART_NO departNo,t2.Sum_Premium premium
        FROM TSS.ts_order t1 INNER JOIN TSS.TS_ORDER_PROPOSAL_MAIN t2 ON t1.order_id = t2.order_id
        AND t1.pay_state = '02'
        AND (t1.SY_POLICY_NO IS NOT NULL OR t1.JQ_POLICY_NO IS NOT NULL)
        AND (
        <![CDATA[
        ( t2.start_date >= #{startDate} AND t2.start_date <= #{endDate})
		]]>
		OR
        <![CDATA[
        (t2.start_date_bz >= #{startDate} AND t2.start_date_bz <= #{endDate})
        ]]>)
    </select>

    <select id="getBranchList" resultType="Branch">
        SELECT DEPT_NO branchNo,PARENT_NAME branchName FROM tss.a_rpt_dept_center
    </select>

    <select id="getReverseAndCorrectOrderList" resultType="Order" parameterType="QueryPara">
        SELECT
        policyno policyNo,chgpremium as premium
        FROM TMS.ITF_CLEC_PMAIN
        WHERE BUSINESSSOURCE IN ('6','u','y') AND
        <![CDATA[
        LOADDATE >= TO_DATE(concat(#{startDate},' 00:00:00'),'yyyy-mm-dd hh24:mi:ss')
		]]>
        AND
        <![CDATA[
        LOADDATE <= TO_DATE(concat(#{endDate},' 00:00:00'),'yyyy-mm-dd hh24:mi:ss')
        ]]>
    </select>
</mapper>
